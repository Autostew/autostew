build_image: drydock/u14pytpls:prod

language: python

python:
  - 3.4
  - 3.5

before_script: mkdir -p shippable/testresults

script:
  - python manage.py makemigrations autostew_web_home autostew_web_enums --settings=autostew.settings.dev
  - python manage.py migrate --settings=autostew.settings.dev
  - coverage run ./manage.py test --settings=autostew.settings.dev
  - coverage xml --omit="**/migrations/*.py,**/__init__.py,**/tests.py,manage.py,**/test_*.py,/root/venv/**/*" -o shippable/codecoverage/coverage.xml

notifications:
email:
  recipients:
    - witmic1@gmail.com
    - contact@joanardiaca.net
  on_success: change
  on_failure: always
